var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};function t(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};function r(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(a){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,r=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,a])}}}function o(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var i=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n}(function(e){function n(t){var n=e.call(this,t)||this;return Object.defineProperty(n,"message",{enumerable:!1,value:t}),Object.defineProperty(n,"name",{enumerable:!1,value:n.constructor.name}),"captureStackTrace"in Error?Error.captureStackTrace(n,n.constructor):Object.defineProperty(n,"stack",{enumerable:!1,value:Error(t).stack,writable:!0,configurable:!0}),n}return t(n,e),n}(Error)),s=function(e){function n(t,n,r,o){return e.call(this,"".concat(t,": expected ").concat(n," to be ").concat(r,", but got ").concat(o,"."))||this}return t(n,e),n.assert=function(e,t,r,o,i){if(!e)throw new n(t,r,o,i);return e},n}(i),c=function(e){function n(t,n,r){var o=t.toString(),i=n.map((function(e){return e.name.toString()}));i.push(o);var s=i.join(" -> "),c="Could not resolve '".concat(o,"'.");return r&&(c+=" ".concat(r)),c+="\n\n",c+="Resolution path: ".concat(s),e.call(this,c)||this}return t(n,e),n}(i),a=function(e){function n(t,n){var r=t.toString(),o="Could not register '".concat(r,"'.");return n&&(o+=" ".concat(n)),e.call(this,o)||this}return t(n,e),n}(i),u={PROXY:"PROXY",CLASSIC:"CLASSIC"},l={SINGLETON:"SINGLETON",TRANSIENT:"TRANSIENT",SCOPED:"SCOPED"};function f(e){var t=e.length,n=0,r="EOF",o="",i=0,s=0,c=0;return{next:function(e){return void 0===e&&(e=0),i=e,a(),o?{value:o,type:r}:{type:r}},done:function(){return"EOF"===r}};function a(){for(o="",r="EOF";;){if(n>=t)return r="EOF";var a=e.charAt(n);if(d(a))n++;else switch(a){case"(":return n++,s++,r=a;case")":return n++,c++,r=a;case"*":case",":return n++,r=a;case"=":return n++,0==(1&i)&&l((function(e){var t=s===c+1;return!((","!==e||!t)&&("("===e?(s++,1):")"!==e||(c++,!t)))})),r=a;case"/":n++;var f=e.charAt(n);"/"===f&&(l((function(e){return"\n"===e}),!0),n++),"*"===f&&(l((function(t){var r=e.charAt(n+1);return"*"===t&&"/"===r}),!0),n++);continue;default:if(y(a))return u(),r;n++}}}function u(){for(var t,i=e.charAt(n),s=++n;t=e.charAt(n),v.test(t);)n++;return o=""+i+e.substring(s,n),"ident"!==(r="function"===o||"class"===o?o:"ident")&&(o=""),o}function l(t,r){for(void 0===r&&(r=!1);n<e.length;){var o=e.charAt(n);if(t(o))return;if(!r){if(d(o)){n++;continue}if(p(o)){f();continue}}n++}}function f(){var t=e.charAt(n);for(n++;n<e.length;){var r=e.charAt(n),o=e.charAt(n-1);if(r===t&&"\\"!==o)return void n++;"`"===t&&"$"===e.charAt(n+1)&&"{"===e.charAt(n+2)&&(n+=2,l((function(e){return"}"===e}))),n++}}}function d(e){switch(e){case"\r":case"\n":case" ":return!0}return!1}function p(e){switch(e){case"'":case'"':case"`":return!0}return!1}var h=/^[_$a-zA-Z\xA0-\uFFFF]$/,v=/^[._$a-zA-Z0-9\xA0-\uFFFF]$/;function y(e){return h.test(e)}function g(e){if("function"!=typeof e)return!1;var t=f(e.toString()),n=t.next();if("class"===n.type)return!0;var r=t.next();return!("function"!==n.type||!r.value||r.value[0]!==r.value[0].toUpperCase())}function w(e){return"function"==typeof e}var m=Symbol("Awilix Resolver Config");function b(e,t){if(!w(e))throw new s("asFunction","fn","function",e);t=x({lifetime:l.TRANSIENT},t,e[m]);var r=C(e);return A(O(n({resolve:r},t)))}function S(e,t){if(!w(e))throw new s("asClass","Type","class",e);t=x({lifetime:l.TRANSIENT},t,e[m]);var r=C((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Reflect.construct(e,t)}),e);return A(O(n(n({},t),{resolve:r})))}function O(e){function t(e){return O(n(n({},this),{lifetime:e}))}function r(e){return O(n(n({},this),{injectionMode:e}))}return E(e,{setLifetime:t,inject:function(e){return O(n(n({},this),{injector:e}))},transient:j(t,l.TRANSIENT),scoped:j(t,l.SCOPED),singleton:j(t,l.SINGLETON),setInjectionMode:r,proxy:j(r,u.PROXY),classic:j(r,u.CLASSIC)})}function A(e){return E(e,{disposer:function(e){return A(n(n({},this),{dispose:e}))}})}function j(e,t){return function(){return e.call(this,t)}}function x(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object.assign.apply(Object,o([{},e],t,!1))}function E(e,t){return n(n({},e),t)}function T(e,t){var n,i=t(e),s=(n=o(o([],Reflect.ownKeys(e.cradle),!0),Reflect.ownKeys(i),!0),Array.from(new Set(n)));return new Proxy({},{get:function(t,n){return n===Symbol.iterator?function(){var t,n,o,s,c,a,u,l;return r(this,(function(r){switch(r.label){case 0:for(o in t=e.cradle,n=[],t)n.push(o);s=0,r.label=1;case 1:return s<n.length?(o=n[s])in t?[4,o]:[3,3]:[3,4];case 2:r.sent(),r.label=3;case 3:return s++,[3,1];case 4:for(u in a=[],c=i)a.push(u);l=0,r.label=5;case 5:return l<a.length?(u=a[l])in c?[4,u]:[3,7]:[3,8];case 6:r.sent(),r.label=7;case 7:return l++,[3,5];case 8:return[2]}}))}:n in i?i[n]:e.resolve(n)},ownKeys:function(){return s},getOwnPropertyDescriptor:function(e,t){if(s.indexOf(t)>-1)return{enumerable:!0,configurable:!0}}})}function C(e,t){t||(t=e);var n=I(t);return function(t){if((this.injectionMode||t.options.injectionMode||u.PROXY)!==u.CLASSIC){var r=this.injector?T(t,this.injector):t.cradle;return e(r)}if(n.length>0){var o=this.injector?function(e,t){return function(n,r){return n in t?t[n]:e.resolve(n,r)}}(t,this.injector(t)):t.resolve,i=n.map((function(e){return o(e.name,{allowUnregistered:e.optional})}));return e.apply(void 0,i)}return e()}}function I(e){var t=function(e){var t=f(e),n=t.next,r=t.done,o=[],i=null;for(d();!r();)switch(i.type){case"class":if(u(),!l())return null;d();break;case"function":"ident"!==(s=d()).type&&"*"!==s.type||d();break;case"(":a();break;case")":return o;case"ident":var s,c={name:i.value,optional:!1};if("async"===i.value&&(s=d())&&"="!==s.type)break;return o.push(c),o;default:throw p()}return o;function a(){for(var e={name:"",optional:!1};!r();)switch(d(),i.type){case"ident":e.name=i.value;break;case"=":e.optional=!0;break;case",":o.push(e),e={name:"",optional:!1};break;case")":return void(e.name&&o.push(e));default:throw p()}}function u(){for(;!l()&&!r();)d(1)}function l(){return"ident"===i.type&&"constructor"===i.value}function d(e){return void 0===e&&(e=0),i=n(e)}function p(){return new SyntaxError("Parsing parameter list, did not expect ".concat(i.type," token").concat(i.value?" (".concat(i.value,")"):""))}}(e.toString());if(!t){var n=Object.getPrototypeOf(e);return"function"==typeof n&&n!==Function.prototype?I(n):[]}return t}var N=Symbol("familyTree"),k=Symbol("rollUpRegistrations"),R="AwilixContainerCradle";function P(e){return void 0===e&&(e={}),$(e)}function $(e,t,i){var f;e=n({injectionMode:u.PROXY,strict:!1},e);var d=null!=i?i:[],p={},h=new Proxy({},{get:function(e,t){return E(t)},set:function(e,t){throw new Error('Attempted setting property "'.concat(t,'" on container cradle - this is not allowed.'))},ownKeys:function(){return Array.from(h)},getOwnPropertyDescriptor:function(e,t){var n=O();if(Object.getOwnPropertyDescriptor(n,t))return{enumerable:!0,configurable:!0}}}),v=((f={options:e,cradle:h,inspect:function(){return"[AwilixContainer (".concat(t?"scoped, ":"","registrations: ").concat(Object.keys(v.registrations).length,")]")},cache:new Map,loadModules:function(){throw new Error("loadModules is not supported in the browser.")},createScope:function(){return $(e,v,d)},register:function(n,r){for(var i=function(e,t){var n,r=e;return"string"==typeof r||"symbol"==typeof r?((n={})[e]=t,n):r}(n,r),s=0,c=o(o([],Object.keys(i),!0),Object.getOwnPropertySymbols(i),!0);s<c.length;s++){var u=c[s],f=i[u];if(e.strict&&f.lifetime===l.SINGLETON&&t)throw new a(u,"Cannot register a singleton on a scoped container.");p[u]=f}return v},build:function(e,t){if(e&&e.resolve)return e.resolve(v);var n="build",r="targetOrResolver";return s.assert(e,n,r,"a registration, function or class",e),s.assert("function"==typeof e,n,r,"a function or class",e),(g(e)?S(e,t):b(e,t)).resolve(v)},resolve:E,hasRegistration:function(e){return!!x(e)},dispose:function(){var e=Array.from(v.cache.entries());return v.cache.clear(),Promise.all(e.map((function(e){var t=e[1],n=t.resolver,r=t.value,o=n;return o.dispose?Promise.resolve().then((function(){return o.dispose(r)})):Promise.resolve()}))).then((function(){}))},getRegistration:x})[k]=O,Object.defineProperty(f,"registrations",{get:function(){return O()},enumerable:!1,configurable:!0}),f),y=t?[v].concat(t[N]):[v];v[N]=y;var w,m=(w=y)[w.length-1];return v;function O(){return n(n({},t&&t[k]()),p)}function A(){var e,t,n,o,i;return r(this,(function(r){switch(r.label){case 0:for(o in e=O(),n=[],t=e)n.push(o);i=0,r.label=1;case 1:return i<n.length?(o=n[i])in t?[4,o]:[3,3]:[3,4];case 2:r.sent(),r.label=3;case 3:return i++,[3,1];case 4:return[2]}}))}function j(){return Object.prototype.toString.call(h)}function x(e){return p[e]||(t?t.getRegistration(e):null)}function E(t,n){n=n||{};try{var r=x(t);if(d.some((function(e){return e.name===t})))throw new c(t,d,"Cyclic dependencies detected.");if("toJSON"===t)return j;if("constructor"===t)return P;if(!r){switch(t){case"inspect":case"toString":return j;case Symbol.toStringTag:return R;case"then":return;case Symbol.iterator:return A}if(n.allowUnregistered)return;throw new c(t,d)}var o=r.lifetime||l.TRANSIENT;if(e.strict&&!r.isLeakSafe){var i=d.findIndex((function(e){var t,n,r=e.lifetime;return n=o,(t=r)===l.SINGLETON&&n!==l.SINGLETON||t===l.SCOPED&&n===l.TRANSIENT}));if(i>-1)throw new c(t,d,"Dependency '".concat(t.toString(),"' has a shorter lifetime than its ancestor: '").concat(d[i].name.toString(),"'"))}d.push({name:t,lifetime:o});var s=void 0,a=void 0;switch(o){case l.TRANSIENT:a=r.resolve(v);break;case l.SINGLETON:(s=m.cache.get(t))?a=s.value:(a=r.resolve(e.strict?m:v),m.cache.set(t,{resolver:r,value:a}));break;case l.SCOPED:if(void 0!==(s=v.cache.get(t))){a=s.value;break}a=r.resolve(v),v.cache.set(t,{resolver:r,value:a});break;default:throw new c(t,d,'Unknown lifetime "'.concat(r.lifetime,'"'))}return d.pop(),a}catch(e){throw d.length=0,e}}}var L=Object.freeze({__proto__:null,AwilixError:i,AwilixRegistrationError:a,AwilixResolutionError:c,AwilixTypeError:s,InjectionMode:u,Lifetime:l,RESOLVER:m,aliasTo:function(e){return{resolve:function(t){return t.resolve(e)},isLeakSafe:!0}},asClass:S,asFunction:b,asValue:function(e){return{resolve:function(){return e},isLeakSafe:!0}},createContainer:P,default:null});function D(e){return e&&"function"==typeof e}function _(e){return!!e&&D(e.resolve)&&D(e.setLifetime)&&D(e.scoped)&&D(e.transient)&&D(e.singleton)}function F(e){return _(e)||function(e){return!!e&&"boolean"==typeof e.isLeakSafe}(e)}let M,z={resolvedDependencies:{},dependencies:{awilix:{get:()=>z.importModule("awilix",(()=>"https://esm.run/awilix@10.0.1/lib/awilix.browser.js"))}},importModule:async function(e,t=((e,t)=>`https://esm.run/${e}`)){let n,r="undefined"!=typeof process&&process?.versions?.node;try{new URL(e),n=!0}catch(e){n=!1}if(n&&r)throw new Error("You cannot import url modules via node.");if(r)return await import(e);return await import(n?e:t(e,z))}},U=0,G=0;function V(e,t,n={}){if(!U)throw new Error("Install before using simplified-awilix");const{existingContainer:r,handleUnregistered:o,config:i}=[e,t,n].reduce(((e,t)=>(D(t)?e.handleUnregistered=t:function(e){return e&&D(e.register)&&D(e.createScope)&&e.cradle}(t)?e.existingContainer=t:e.config=t,e)),{});return Y({container:r,handleUnregistered:o,config:i})}function Y(e={}){let{AwilixResolutionError:t,config:n,createContainer:r,asFunction:o,asValue:i,aliasTo:s,container:c,handleUnregistered:a=(()=>{})}={...M,...e};c||(c=r?.(n));let u=c.cradle;const l=c._createScope||=c.createScope,f=c._register||=c.register;function d(e,t="transient",n){"string"==typeof e&&(e={[e]:t},t=n||"transient");for(const[n,r]of Object.entries(e)){let e=r;if("object"==typeof r&&!F(r)&&D(r?.resolver)||_(r?.resolver)){const{resolver:i,disposer:s,inject:c,injector:a=c,type:u,lifetime:l=u||t}=r;e=o(i),D(s)&&(e=e.disposer(s)),D(a)&&(e=e.inject(s)),f(n,e[l]())}else F(e)?e.resolve&&!e[t]?f(n,e):f(n,e[t]()):D(e)?f(n,o(e)[t]()):f(n,i(e))}return c}const[p,h,v,y]=["Singleton","Scoped","Transient",""].map((e=>(t,...n)=>{"string"==typeof t&&(t=[t]);const r=Object.keys(c.cradle);return t.every((e=>r.includes(e)))&&c["register"+e](...n),c})),[g,w,m,b]=["Singleton","Scoped","Transient",""].map((e=>(t,...n)=>{"string"==typeof t&&(t=[t]);const r=Object.keys(c.cradle);return t.every((e=>r.includes(e)))||c["register"+e](...n),c}));return Object.defineProperty(c,"cradle",{get:()=>new Proxy(u,{get(e,n){try{return e[n]}catch(e){if(e instanceof t||e.message.startsWith("Could not resolve"))return a(n,c.cradle);throw e}}})}),function(e,...t){const n=t.length;if(n<1||null==e)return e;for(let r=0;r<n;r++){const n=t[r];for(const t in n)e[t]=n[t]}return e}(c,{register:d,registerTransient:function(...e){return d(...e,"transient")},registerScoped:function(...e){return d(...e,"scoped")},registerSingleton:function(...e){return d(...e,"singleton")},createScope:function(e=a){return Y({AwilixResolutionError:t,createContainer:r,asFunction:o,asValue:i,aliasTo:s,container:l(),handleUnregistered:e})},registerSingletonIf:p,registerScopedIf:h,registerTransientIf:v,registerIf:y,registerSingletonIfNot:g,registerScopedIfNot:w,registerTransientIfNot:m,registerIfNot:b})}await async function(e={}){const t={...z,...e};if(U++)return V;if(G++)return new Promise((e=>{const t=setInterval((()=>{G||(e(V),clearInterval(t))}),100)}));const{dependencies:n}=t;return M=await n.awilix.get(),V}({resolvedDependencies:{awilix:L}});let X=(e=21)=>{let t="",n=e;for(;n--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return t};class q extends Error{constructor(e){super(e)}}class K extends q{constructor(e){super(`Dependency "${e}" is not serializable.`)}}class J extends q{constructor(e){super(`Dependency "${e}" is not installed.`),this.dependency=e}}class W extends q{constructor(e,t){super(`Dependency "${e}" could not be installed because ${t.message}`),this.dependency=e,this.error=t}}class Z extends J{constructor(e,t){super(`A non-optional dependency "${e}" could not be resolved.`),this.dependency=e,this.error=t}}class B extends q{constructor(e,t){super(`"${e}" dependency could not be added because ${t}`)}}class H extends q{constructor(e,t){super(`"${e}" could not be validated ${t?"because "+t?.message||t:""}`)}}class Q extends Error{constructor(e,t){super(`Installation error of "${e}" because `+(t?.message||t))}}class ee extends Error{constructor(e,t){const n=t.map((e=>e?.message||e)).join("\n\r - ");console.error(`\n        ${e}\n        Multiple Errors:\n        ${n}\n        `),super(e)}}class te extends Error{constructor(e,t,n){super(`Stage Merger Error initiator stage: ${e} cannot receive merge of target stage: ${e} because: ${n}`)}}function ne(e,t){const n=Array.isArray(t)?t:t.split(".");return!!e&&(n.length>1?ne(e[n[0]],n.slice(1).join(".")):hasOwnProperty.call(e,t))}function re(e,t,n=void 0){const r=n=>String.prototype.split.call(t,n).filter(Boolean).reduce(((e,t)=>null!=e?e[t]:e),e),o=r(/[,[\]]+?/)||r(/[,[\].]+?/);return void 0===o||o===e?n:o}function oe(e,t,n){let r=t;"string"==typeof t&&(r=t.split(/[,[\]]+?/));let o=e;for(let t=0;t<r.length;t++){const i=r[t];t===r.length-1&&(o[i]=n),o[i]||(o[i]={}),o=e[i]}return e}function ie(e){for(let t in e)e.hasOwnProperty(t)&&delete e[t]}async function se(e,t={}){try{return await import(function(e,t={}){const{mimeType:n="text/javascript",charset:r="utf-8"}=t;let o="";return null!==r&&(o+=`charset=${r};`),`data:${n};${o}base64,${btoa(e)}`}(e,t))}catch(e){if("ERR_INVALID_URL"===e.code)throw new TypeError("Could not import code. If the code has any 'require' or 'import' statements, the import will not work without a bundler.");throw e}}async function ce(e,t){const{valid:n}=t.cradle;let r;try{if(!(r=await Promise.resolve(n)))throw await t.dispose(),new H(e)}catch(n){throw await t.dispose(),new H(e,n)}t.register({valid:r}).registerScoped({installed:!0})}async function ae(e,t,n){return"object"==typeof e&&(e={...e}),t&&e?.default&&(e[t]=e.default),"object"==typeof e&&Object.keys(e).every((e=>"default"===e))&&(e=e.default),n&&n.length&&(e=Object.entries(e).reduce(((e,[t,r])=>(n.includes(t)&&(e[t]=r),e)))),null!=e&&(e=await Promise.resolve(e)),e}function ue(e,t){if("function"==typeof t){let e=t+"";e.startsWith("validator")&&(e=e.replace("validator","function")),t=`(${e})(arguments[0])`}let n;const r=`/*${e}*/`;if("string"!=typeof t||t.includes(r))n=!1;else{const e=t;n=async t=>{const n=Object.keys(t).filter((e=>"validator"!==e&&"valid"!==e)).join(","),o=`${r}export default function ({${n}}) { return () => ${e}; }`;let i=await Promise.resolve((await se(o))?.default(t));return"function"==typeof i&&(i=await i(t)),i}}return{validator:t,valid:n}}const le=V().registerScoped({id:()=>X(),installed:()=>!1,name:"",container:()=>{},optional:!1,importSources:()=>[],code:void 0,uri:void 0,module:void 0,install:function(e){return async(t=!0)=>{const{container:n,name:r,module:o,npmSpecifier:i,code:s,uri:c,importSources:a,optional:u,exports:l,defaultAs:f,installed:d,npmCdnResolver:p}=e;if(d)throw new W(r,"Already installed.");let h=o;if(null==h){const e=[...a];if(i&&i)if("undefined"!=typeof process&&process?.versions?.node)e.unshift(import(i));else if(p){if("undefined"!=typeof document)try{const{imports:t}=JSON.parse(document.querySelector("[type='importmap']").innerHTML);t[i]&&e.unshift(import(i))}catch(e){}e.unshift(p(i))}s&&e.unshift(se(s)),c&&e.unshift(import(c));for await(const[o,i]of Object.entries(e))try{h=await i,h=await ae(h,f,l),t&&(n.register({module:h}),await ce(r,n))}catch(t){n.register({module:void 0}),e.splice(+o),h=void 0}if(null==h)throw new Z(r,"All import sources failed to resolve dependency")}else h=await ae(h,f,l),t&&await ce(r,n);return h&&n.registerScoped({module:h}),t||n.register({valid:!1}).registerScoped({installed:!0,validator:void 0}),n.cradle}},exports:[],validator:async e=>!!e,dispose:({container:e})=>()=>(e.registerScoped({installed:!1,module:void 0}),e.dispose())}).registerTransient({snapshot:function(e){return()=>{const{isSerializable:t,name:n}=e;if(!t)return new q(`Dependency "${n}" is not serializable.`);const r={};for(let[t,n]of Object.entries(e))if(n&&"validator"===t&&"string"!=typeof n&&(n=ue(e.id,n).validator),null!=n&&!["valid","installed","isSerializable"].includes(t))try{structuredClone(n),r[t]=n}catch(e){}return r}},isSerializable:function({code:e,uri:t,npmSpecifier:n,importSources:r}){return(e||t||n||r.length)&&function(e){try{return!!structuredClone(e)}catch(e){return!1}}(e||t||n||r)}});const fe={resolver:({get:e})=>t=>Array.isArray(t)?t.every((e=>!!e)):!!e(t),type:"transient"};const de=X(),pe={},he=V().registerSingleton({rootId:de}).registerScoped({depth:0,merge:function(e){const{dependencies:t,depth:n,rootId:r,id:o}=e;return({dependencies:i,depth:s,rootId:c,id:a})=>{if(s<n&&r===c)throw new te(o,a,"cannot merge a scoped stage into its parent stage.");for(const[e,n]of Object.entries(i))ne(t,e)||oe(t,e,n);return e}},id:()=>de,container:()=>he,install:function({dependencies:e,requireDependencyValidation:t,id:n,npmCdnResolver:r}){return async(r=t)=>{let o={},i=[],s=0;for await(const t of Object.values(e)){const{name:e,optional:n,install:c,installed:a}=t.cradle;if(a)oe(o,e,t);else try{await c(r),oe(o,e)}catch(e){if(!(e instanceof q))throw e;n||s++,i.push(e)}}if(s){if(i.length>1)throw new ee(n,i);if(1===i.length)throw new Q(n,i[0])}return o}},forks:{resolver:()=>[],disposer:e=>e.length=0},pack:null,packConfiguration:{},dependencies:{resolver:()=>pe,disposer:ie},requireDependencyValidation:!0,installDependency:function({dependencies:e}){return(t,n)=>re(e,t).install(n)},npmCdnResolver:()=>e=>import(`https://cdn.jsdelivr.net/npm/${e}/+esm`),put:function({id:e,dependencies:t,container:n,forks:r,npmCdnResolver:o}){const i=(s,c={},a={})=>{const{reinstall:u=!1}=a;if(Array.isArray(s))return s.map((e=>i(...Array.isArray(e)?e:[e])));"string"!=typeof s&&(c={...c,...s});let l,{name:f=s,validator:d,...p}=c;if(!f)throw new B("Name not defined","name of dependency was not defined");if(ne(t,f)&&!u){const e=re(t,f),{installed:n}=e.cradle;if(n)throw new B(f,"dependency already installed.");l=e}else l=le.createScope();const h=ue(e,d);d=h.validator;let v=h.valid;l.registerScoped({id:X(),container:l,stage:n,name:f,npmCdnResolver:()=>o,...p}).registerTransient({validator:d,valid:v}),oe(t,f,l);for(const e of r)e.dependencies[f]||=l;return l.cradle};return i},get:function({dependencies:e}){return function t(n,r=!1){return Array.isArray(n)?n.flat().map((e=>t(e))):r?re(e,n):re(e,n)?.cradle}},execute:function({get:e}){return function(t){const n=e(Array.isArray(t)?t:[t]).map((e=>{if(!e.installed)throw new J(e);return e.installed?e.module:void 0}));return Array.isArray(t)?n:n[0]}},dispose:({container:e})=>()=>e.dispose(),fork:function({container:e,depth:t,dependencies:n,forks:r}){return o=>{const i=e.createScope(),s={...n},c=X(),a=r.push(i.cradle)-1;if(i.registerScoped({id:c,container:()=>i,depth:t+1,dispose:({container:e})=>()=>e.dispose(),dependencies:{resolver:()=>s,disposer:e=>{ie(e),r.splice(a,1)}}}),"object"==typeof o){const e={};let t=!1;for(const[n,r]of Object.entries(o))if("dependencies"===n)for(const e of Object.values(r))i.cradle.put(e);else e[n]=r,t=!0;t&&i.registerScoped(e)}return i.cradle}},ifExists:function(e){return(t,n)=>{const{exists:r,get:o}=e;if(Array.isArray(t)?t.every((e=>r(e))):r(t))return n(o(t),e)}}}).registerTransient({exists:fe,snapshot:function(e){return()=>{const{dependencies:t}=e,n={dependencies:{}};for(const[t,r]of Object.entries(e))if(null!=r&&!["dependencies","isSerializable"].includes(t))try{structuredClone(r),n[t]=r}catch(e){}const r=[];for(const[e,o]of Object.entries(t)){if(!o)throw new q("Stage.dependencies corrupted. Cannot serialize.");const{snapshot:t,isSerializable:i}=o.cradle;i?r.length||(n.dependencies[e]=t()):r.push(new K(e))}if(1===r.length){const[e]=r;throw e}if(r>1)throw new ee("Stage.toJSON",r);return n}},isSerializable:function({dependencies:e}){return Object.values(e).every((e=>e.cradle.isSerializable))}});const ve=he,ye=ve.cradle,{install:ge}=ye;export{ge as install,ye as stage,ve as stageContainer};
